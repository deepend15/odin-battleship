(()=>{"use strict";class t{constructor(t,e,n){this.name=t,this.id=`Player ${e}`,this.type=n}lastAttack=null;lastAttackResult=null;gameboard=function(){const t=[],e=function(){const t=[Object.assign({},{isSunk:function(){return!(this.hits<this.length)},hit:function(){this.isSunk()||(this.hits+=1)},hits:0,placed:!1},{length:5,id:"5"}),Object.assign({},{isSunk:function(){return!(this.hits<this.length)},hit:function(){this.isSunk()||(this.hits+=1)},hits:0,placed:!1},{length:4,id:"4"}),Object.assign({},{isSunk:function(){return!(this.hits<this.length)},hit:function(){this.isSunk()||(this.hits+=1)},hits:0,placed:!1},{length:3,id:"3A"}),Object.assign({},{isSunk:function(){return!(this.hits<this.length)},hit:function(){this.isSunk()||(this.hits+=1)},hits:0,placed:!1},{length:3,id:"3B"}),Object.assign({},{isSunk:function(){return!(this.hits<this.length)},hit:function(){this.isSunk()||(this.hits+=1)},hits:0,placed:!1},{length:2,id:"2"})];return{getShips:()=>t}}().getShips();for(let e=0;e<10;e++){t[e]=[];for(let n=0;n<10;n++)t[e].push(null)}return{ships:e,getBoard:()=>t,placeShip:function(e,n,a){if([n[0],n[1],a[0],a[1]].forEach((t=>{if(t<0||t>9)throw new Error("Invalid coordinates")})),n[0]!==a[0]&&n[1]!==a[1])throw new Error("Invalid coordinates");if(n[0]===a[0]&&a[1]-n[1]!=e.length-1&&-1*(a[1]-n[1])!=e.length-1)throw new Error("Invalid coordinates");if(n[1]===a[1]&&a[0]-n[0]!=e.length-1&&-1*(a[0]-n[0])!=e.length-1)throw new Error("Invalid coordinates");const s=[n];let o=n[0],i=n[1];for(let t=1;t<e.length-1;t++)n[0]===a[0]?n[1]<a[1]?i+=1:i-=1:n[0]<a[0]?o+=1:o-=1,s.push([o,i]);s.push(a),s.forEach((n=>{if(null!==t[n[0]][n[1]])throw new Error("Coordinates already occupied!");t[n[0]][n[1]]=[e.id]}))},clearBoard:function(){t.forEach((t=>{for(let e=0;e<t.length;e++)t[e]=null}))},receiveAttack:function([n,a]){const s=e.map((t=>t.id));if(null!==t[n][a]){if(t[n][a].includes("miss"))throw new Error("Can't attack this spot");s.forEach((s=>{if(t[n][a].includes(s)){if(t[n][a].includes("hit"))throw new Error("Can't attack this spot");const o=e.filter((t=>t.id===s))[0];return o.hit(),t[n][a].push("hit"),void(o.isSunk()&&t.forEach((t=>{t.forEach((t=>{Array.isArray(t)&&t.includes(s)&&t.push("is sunk")}))})))}}))}else t[n][a]=["miss"]},allShipsSunk:function(){for(let t=0;t<e.length;t++)if(!e[t].isSunk())return!1;return!0}}}()}const e=function(){let e,n,a,s,o,i="new";return{getPlayer1:()=>e,getPlayer2:()=>n,getActivePlayer:()=>a,getOpponent:()=>s,switchPlayerTurn:()=>{a===e?(a=n,s=e):(a=e,s=n)},getGameStatus:()=>i,setGameStatus:t=>i=t,startGame:(o,i="Computer",c="computer")=>{e=new t(o,1,"human"),n=new t(i,2,c),a=e,s=n},setWinner:t=>o=t,getWinner:()=>o}}();function n(t){const n=document.querySelector("#new-game-dialog");let a;a="1 player"===t.target.textContent?1:2,n.textContent="";const s=document.createElement("button");s.classList.add("dialog-cancel-btn"),s.textContent="X",n.append(s),s.addEventListener("click",(()=>n.close()));const o=document.createElement("form"),i=document.createElement("p"),c=document.createElement("label");let r;c.setAttribute("for","p1-name"),r=1===a?"Your ":"Player 1 ",c.textContent=r+"name:";const d=document.createElement("input");let u;if(d.setAttribute("type","text"),d.setAttribute("id","p1-name"),d.setAttribute("name","p1-name"),d.setAttribute("placeholder","Player 1"),d.setAttribute("required",""),i.append(c,d),o.append(i),2===a){const t=document.createElement("p"),e=document.createElement("label");e.setAttribute("for","p2-name"),e.textContent="Player 2 name:",u=document.createElement("input"),u.setAttribute("type","text"),u.setAttribute("id","p2-name"),u.setAttribute("name","p2-name"),u.setAttribute("placeholder","Player 2"),u.setAttribute("required",""),t.append(e,u),o.append(t)}const m=document.createElement("button");m.textContent="OK",m.setAttribute("formmethod","dialog"),o.append(m),m.addEventListener("click",(()=>{""===d.value&&(d.value="Player 1"),2===a&&""===u.value&&(u.value="Player 2"),1===a?e.startGame(d.value):e.startGame(d.value,u.value,"human"),e.setGameStatus("ship-placement"),l.updateScreen()})),n.append(o)}function a(){const t=document.querySelector("#new-game-dialog");t.textContent="";const e=document.createElement("button");e.classList.add("dialog-cancel-btn"),e.textContent="X",t.append(e),e.addEventListener("click",(()=>t.close()));const a=document.createElement("div");a.classList.add("choose-players-div");const s=document.createElement("p");s.textContent="Choose the number of players:";const o=document.createElement("div");o.classList.add("player-buttons-div");const i=document.createElement("button");i.textContent="1 player";const c=document.createElement("button");c.textContent="2 players",o.append(i,c),a.append(s,o),t.append(a),i.addEventListener("click",n),c.addEventListener("click",n),t.showModal()}class s{constructor(t,e){this.player=t,this.status=e}activeShip=null;selectedStartingSquare=null}function o(t,e){const n=e[0],a=e[1],s={firstPosition:null,secondPosition:null,thirdPosition:null,fourthPosition:null};let o=[];if(a+t.length-1<=9){for(let e=a;e<a+t.length;e++)o.push([n,e]);s.firstPosition=o}if(a-t.length+1>=0){o=[];for(let e=a;e>a-t.length;e--)o.push([n,e]);s.secondPosition=o}if(n+t.length-1<=9){o=[];for(let e=n;e<n+t.length;e++)o.push([e,a]);s.thirdPosition=o}if(n-t.length+1>=0){o=[];for(let e=n;e>n-t.length;e--)o.push([e,a]);s.fourthPosition=o}return s}function i(t){const e=t.gameboard,n=e.getBoard();function a(){const t=[];function e(){const e=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());t.push([e,n])}let a;for(e();0!==t.length;)s=t[0],null===n[s[0]][s[1]]?a=t.shift():(e(),t.shift());var s;return a}return{placeInRandomPosition:function(t,s=null){function i(e){const n=o(t,e),a=Object.values(n).filter((t=>null!==t)),s=a.length;return a[Math.floor(Math.random()*s)]}function c(t){let e=!1;return t.forEach((t=>{null!==n[t[0]][t[1]]&&(e=!0)})),e}const l=[];let r,d,u;for(null===s&&(r=a()),d=i(null===s?r:s),l.push(d);0!==l.length;)c(l[0])?null===s?(r=a(),d=i(r),l.push(d),l.shift()):(d=i(s),l.push(d),l.shift()):(u=(m=l[0])[m.length-1],null===s?e.placeShip(t,r,u):e.placeShip(t,s,u),t.placed=!0,l.shift());var m}}}function c(t){const n=t.player,a=e.getPlayer2(),r=n.gameboard.ships,d=t.status,u=t.activeShip,m=document.querySelector(".game-div"),p="ABCDEFGHIJ".split(""),h="1,2,3,4,5,6,7,8,9,10".split(",");m.textContent="","H2"===m.previousElementSibling.nodeName&&m.previousElementSibling.remove();const f=document.createElement("h2");f.textContent=`${n.name}, place your ships on your board!`,m.before(f);const g=document.createElement("div");g.classList.add("ship-placement-section"),m.append(g);const v=document.createElement("div");v.classList.add("ship-placement-text-div");const E=document.createElement("div");E.classList.add("ship-placement-lines");const S=document.createElement("p");switch(d){case"click-ship":S.textContent="Click on a ship:";break;case"starting-square":S.textContent="Click a starting square on your board.";break;case"ending-square":S.textContent="Click an available position on your board to place your ship.";break;case"next-player-ready":S.textContent=`Click "Continue" to allow ${a.name} to place their ships!`;break;case"game-ready":S.textContent='Click "Start Game" to start the game!'}E.append(S),v.append(E),g.append(v);const y=document.createElement("div");y.classList.add("ship-selection-div"),r.forEach((t=>{const e=document.createElement("div");e.classList.add("ship-selection-line");const n=document.createElement("button");n.classList.add("ship-selection-button"),null!==u&&(t.id===u.id?n.classList.add("active-ship"):n.classList.add("inactive-ship"));const a=document.createElement("p");switch(t.id){case"5":a.textContent="Carrier:";break;case"4":a.textContent="Battleship:";break;case"3A":a.textContent="Destroyer:";break;case"3B":a.textContent="Submarine:";break;case"2":a.textContent="Patrol Boat:"}const s=document.createElement("div");s.classList.add("ship-div");for(let e=0;e<t.length;e++){const e=document.createElement("div");e.textContent=t.length.toString(),s.append(e)}n.append(a,s),e.append(n);const o=document.createElement("p");let i;!0===t.placed?(o.classList.add("placed-text-placed"),i="✅"):(o.classList.add("placed-text-not-placed"),i="🗙"),o.textContent=i+" placed",e.append(o),y.append(e)})),g.append(y),("click-ship"===d||"game-ready"===d||"next-player-ready"===d)&&document.querySelectorAll(".ship-selection-button").forEach((e=>{function n(){let t;switch(e.firstElementChild.textContent){case"Carrier:":t="5";break;case"Battleship:":t="4";break;case"Destroyer:":t="3A";break;case"Submarine:":t="3B";break;case"Patrol Boat:":t="2"}return r.filter((e=>e.id===t))[0]}if(e.nextElementSibling.classList.contains("placed-text-placed")){e.classList.add("inactive-ship");const a=document.createElement("button");a.classList.add("edit-ship-button"),a.textContent="re-place",e.parentElement.append(a),a.addEventListener("click",(()=>{const e=n();b.forEach((t=>{for(let n=0;n<t.length;n++)Array.isArray(t[n])&&t[n].includes(e.id)&&(t[n]=null)})),e.placed=!1,t.activeShip=e,t.status="starting-square",c(t)}))}else if("click-ship"===d){function s(t){t.target.classList.toggle("ship-hover")}e.addEventListener("mouseenter",s),e.addEventListener("mouseleave",s),e.addEventListener("click",(()=>{t.status="starting-square",t.activeShip=n(),c(t)}))}}));const k=document.createElement("div");if(k.classList.add("ship-placement-buttons"),"game-ready"===d){const w=document.createElement("button");w.classList.add("start-game-button"),w.textContent="Start Game",k.append(w),w.addEventListener("click",(()=>{"computer"===a.type&&a.gameboard.ships.forEach((t=>i(a).placeInRandomPosition(t))),e.setGameStatus("player-turn"),l.updateScreen()}))}else if("next-player-ready"===d){const P=document.createElement("button");P.classList.add("start-game-button"),P.textContent="Continue",k.append(P),P.addEventListener("click",(()=>{const t=document.querySelector(".main-container"),e=document.createElement("dialog");e.id="next-player-ship-placement-dialog";const o=document.createElement("div"),i=document.createElement("span");i.classList.add("next-player-dialog-player1-name"),i.textContent=n.name;const l=document.createElement("span");l.classList.add("next-player-dialog-player2-name"),l.textContent=a.name;const r=l.cloneNode(!0),d=document.createElement("p");d.append(i,", pass the screen to "),d.append(l," so they can place their ships!");const u=document.createElement("p");u.append(r,", click OK when you're ready to continue!");const m=document.createElement("div");m.classList.add("next-player-dialog-buttons");const p=document.createElement("button");p.textContent="Cancel";const h=document.createElement("button");h.textContent="OK",m.append(p,h),o.append(d,u,m),e.append(o),t.append(e),p.addEventListener("click",(()=>{e.close(),e.remove()})),h.addEventListener("click",(()=>{e.close(),e.remove(),c(new s(a,"click-ship"))})),e.showModal()}))}else{const G=document.createElement("button");G.classList.add("ship-placement-random-button"),"click-ship"===d?(G.textContent="Place my ships for me!",G.addEventListener("click",(()=>{r.forEach((t=>{t.placed||i(n).placeInRandomPosition(t)})),t.activeShip=null,t.selectedStartingSquare=null,"computer"===a.type||"human"===a.type&&"Player 2"===n.id?t.status="game-ready":t.status="next-player-ready",c(t)}))):(G.textContent="Place this ship for me!","starting-square"===d&&G.addEventListener("click",(()=>{i(n).placeInRandomPosition(u),u.placed=!0,t.activeShip=null,t.selectedStartingSquare=null,0===r.filter((t=>!t.placed)).length?"computer"===a.type||"human"===a.type&&"Player 2"===n.id?t.status="game-ready":t.status="next-player-ready":t.status="click-ship",c(t)})),"ending-square"===d&&G.addEventListener("click",(()=>{i(n).placeInRandomPosition(u,t.selectedStartingSquare),u.placed=!0,t.activeShip=null,t.selectedStartingSquare=null,0===r.filter((t=>!t.placed)).length?"computer"===a.type||"human"===a.type&&"Player 2"===n.id?t.status="game-ready":t.status="next-player-ready":t.status="click-ship",c(t)}))),k.append(G)}const L=document.createElement("button");L.classList.add("reset-board-button"),L.textContent="Reset board",k.append(L),L.addEventListener("click",(()=>{n.gameboard.clearBoard(),r.forEach((t=>t.placed=!1)),t.activeShip=null,t.selectedStartingSquare=null,t.status="click-ship",c(t)})),g.append(k);const b=n.gameboard.getBoard(),x=document.createElement("div");x.classList.add("board-div");const C=document.createElement("div");C.classList.add("column-labels");for(let N=0;N<10;N++){const T=document.createElement("p");T.textContent=p[N],C.append(T)}const A=document.createElement("div");A.classList.add("row-labels");for(let B=0;B<10;B++){const M=document.createElement("p");M.textContent=h[B],A.append(M)}const q=document.createElement("div");if(q.classList.add("board"),x.append(C,A,q),b.forEach(((e,n)=>{let a=n;e.forEach(((e,n)=>{const s=document.createElement("div");if(s.classList.add("square"),s.dataset.row=a,s.dataset.column=n,null!==e&&(e.includes("3A")||e.includes("3B")?s.textContent="3":s.textContent=e[0]),q.append(s),"game-ready"!==d&&"next-player-ready"!==d||""!==s.textContent&&s.classList.add("active-player-ship"),"ending-square"===d){const i=[Number(s.dataset.row),Number(s.dataset.column)];if(i[0]===t.selectedStartingSquare[0]&&i[1]===t.selectedStartingSquare[1])s.classList.add("neutral-square");else{const c=o(u,t.selectedStartingSquare);function l(t,e){return 0!==e.filter((e=>e[0]===t[0]&&e[1]===t[1])).length}function r(t){let e=!1;return t.forEach((t=>{null!==b[t[0]][t[1]]&&(e=!0)})),e}null!==c.firstPosition&&l(i,c.firstPosition)&&!r(c.firstPosition)?s.classList.add("position-1"):null!==c.secondPosition&&l(i,c.secondPosition)&&!r(c.secondPosition)?s.classList.add("position-2"):null!==c.thirdPosition&&l(i,c.thirdPosition)&&!r(c.thirdPosition)?s.classList.add("position-3"):null!==c.fourthPosition&&l(i,c.fourthPosition)&&!r(c.fourthPosition)?s.classList.add("position-4"):s.classList.add("inactive-square")}}}))})),m.append(x),"click-ship"===d&&x.classList.add("inactive-board"),"starting-square"===d){function I(t){t.target.classList.toggle("hover")}document.querySelectorAll(".square").forEach((e=>{""===e.textContent?(e.addEventListener("mouseover",I),e.addEventListener("mouseout",I),e.addEventListener("click",(e=>{const n=[Number(e.target.dataset.row),Number(e.target.dataset.column)];!function(t){const e=o(u,t),n=Object.values(e).filter((t=>null!==t)),a=[];return n.forEach((t=>{(function(t){let e=!1;return t.forEach((t=>{null!==b[t[0]][t[1]]&&(e=!0)})),e})(t)&&a.push(t)})),a.length!==n.length}(n)?document.querySelector(".ship-placement-lines").textContent="Invalid square! Choose another starting square.":(t.selectedStartingSquare=n,t.status="ending-square",c(t))}))):e.classList.add("active-player-ship")}))}if("ending-square"===d){let R=[],O=[],K=[],H=[];document.querySelectorAll(".square").forEach((t=>{t.classList.contains("position-1")&&R.push(t),t.classList.contains("position-2")&&O.push(t),t.classList.contains("position-3")&&K.push(t),t.classList.contains("position-4")&&H.push(t)})),[R,O,K,H].forEach((e=>{0!==e.length&&e.forEach((s=>{s.addEventListener("mouseover",(()=>{const t=document.querySelector(".neutral-square");t.classList.toggle("position-group-hover"),t.textContent=u.length,e.forEach((t=>{t.classList.toggle("position-group-hover"),t.textContent=u.length}))})),s.addEventListener("mouseout",(()=>{const t=document.querySelector(".neutral-square");t.classList.toggle("position-group-hover"),t.textContent="",e.forEach((t=>{t.classList.toggle("position-group-hover"),t.textContent=""}))})),s.addEventListener("click",(()=>{const e=document.querySelectorAll(".position-group-hover"),s=e[0],o=e[e.length-1];n.gameboard.placeShip(u,[Number(s.dataset.row),Number(s.dataset.column)],[Number(o.dataset.row),Number(o.dataset.column)]),r.filter((t=>t.id===u.id))[0].placed=!0,t.activeShip=null,t.selectedStartingSquare=null,0===r.filter((t=>!t.placed)).length?"computer"===a.type||"human"===a.type&&"Player 2"===n.id?t.status="game-ready":t.status="next-player-ready":t.status="click-ship",c(t)}))}))}))}}const l=function(){const t=()=>{window.scrollTo(0,0);const t=document.querySelector(".game-div"),n=document.querySelector(".top-line-menu-div"),i="ABCDEFGHIJ".split(""),r="1,2,3,4,5,6,7,8,9,10".split(",");if("H2"===t.previousElementSibling.nodeName&&t.previousElementSibling.remove(),t.textContent="",n.textContent="",t.nextElementSibling&&t.nextElementSibling.remove(),"new"===e.getGameStatus()){const d=document.createElement("button");d.textContent="New game",t.before(d),d.addEventListener("click",a);const u=document.createElement("div");u.classList.add("board-div");const m=document.createElement("div");m.classList.add("column-labels");for(let f=0;f<10;f++){const g=document.createElement("p");g.textContent=i[f],m.append(g)}const p=document.createElement("div");p.classList.add("row-labels");for(let v=0;v<10;v++){const E=document.createElement("p");E.textContent=r[v],p.append(E)}const h=document.createElement("div");h.classList.add("board"),u.append(m,p,h);for(let S=0;S<100;S++){const y=document.createElement("div");y.classList.add("square"),h.append(y)}t.append(u)}else{"BUTTON"===t.previousElementSibling.nodeName&&t.previousElementSibling.remove();const k=e.getActivePlayer(),L=k.gameboard,b=L.getBoard(),x=e.getOpponent(),C=x.gameboard,A=C.getBoard(),q=C.ships;if("ship-placement"===e.getGameStatus())c(new s(k,"click-ship"));else{const w=document.querySelector(".main-container"),P=document.createElement("div");P.classList.add("bottom-div"),w.append(P),function(){const t=document.querySelector("body"),n=document.querySelector(".top-line-menu-div"),s=document.createElement("button");s.dataset.closeEventListener="OFF",s.textContent="Options";const o=document.createElement("div");o.classList.add("options-button-menu"),o.classList.add("hidden");const i=document.createElement("button");i.classList.add("options-menu-row"),i.textContent="New game";const c=document.createElement("button");c.classList.add("options-menu-row"),c.textContent="Restart game",o.append(i,c),n.append(s,o),i.addEventListener("click",a),c.addEventListener("click",(()=>{const n=e.getPlayer1(),a=e.getPlayer2(),s=document.createElement("dialog");s.setAttribute("id","restart-game-dialog");const o=document.createElement("button");o.classList.add("dialog-cancel-btn"),o.textContent="X",s.append(o),o.addEventListener("click",(()=>{s.close(),s.remove()}));const i=document.createElement("p");i.textContent="❗",s.append(i);const c=document.createElement("p");c.textContent="Are you sure you want to restart this game?",s.appendChild(c);const r=document.createElement("div");r.classList.add("restart-game-dialog-buttons");const d=document.createElement("button");d.textContent="No",r.appendChild(d);const u=document.createElement("button");u.textContent="Yes",r.appendChild(u),s.appendChild(r),t.appendChild(s),s.showModal(),d.addEventListener("click",(()=>{s.close(),s.remove()})),u.addEventListener("click",(()=>{const t=e.getActivePlayer(),o=n.gameboard.ships,i=a.gameboard.ships,c=n.gameboard.getBoard(),r=a.gameboard.getBoard();s.close(),s.remove(),"Player 2"===t.id&&e.switchPlayerTurn(),o.forEach((t=>t.hits=0)),i.forEach((t=>t.hits=0)),n.lastAttack=null,n.lastAttackResult=null,a.lastAttack=null,a.lastAttackResult=null,"computer"===a.type&&(delete a.attackTurn,delete a.firstHit,delete a.hitButNotSunkShips,delete a.tryingToSink);const d=["2","3A","3B","4","5"];function u(t){let e=!1;for(let n=0;n<d.length;n++){const a=d[n];if(t.includes(a)){e=!0;break}}return e}c.forEach((t=>{for(let e=0;e<t.length;e++)if(Array.isArray(t[e]))if(u(t[e])){const n=t[e].filter((t=>d.includes(t)));t[e]=n}else t[e]=null})),r.forEach((t=>{for(let e=0;e<t.length;e++)if(Array.isArray(t[e]))if(u(t[e])){const n=t[e].filter((t=>d.includes(t)));t[e]=n}else t[e]=null})),e.setGameStatus("player-turn"),l.updateScreen()}))})),s.addEventListener("mouseenter",(()=>{s.classList.toggle("options-btn-hover")})),s.addEventListener("mouseleave",(()=>{s.classList.toggle("options-btn-hover")}));const r=new CustomEvent("menuCloseEvent");function d(){s.classList.remove("options-btn-active"),o.classList.add("hidden"),s.dispatchEvent(r)}s.addEventListener("click",(e=>{e.stopPropagation(),s.classList.contains("options-btn-active")?d():(s.classList.add("options-btn-active"),o.classList.remove("hidden"),t.addEventListener("click",d),"OFF"===s.dataset.closeEventListener&&(s.addEventListener("menuCloseEvent",(()=>{t.removeEventListener("click",d)})),s.dataset.closeEventListener="ON"))}))}();const G=document.createElement("div");G.classList.add("info-div");const N=document.createElement("div");N.classList.add("info-div-players");const T=document.createElement("p");T.classList.add("info-active-player"),T.textContent="Current turn: ";const B=document.createElement("p");B.classList.add("info-active-player"),"computer-attack"===e.getGameStatus()?B.textContent=`${x.name}`:B.textContent=`${k.name}`;const M=document.createElement("p");M.classList.add("info-opponent"),M.textContent="Opponent: ";const I=document.createElement("p");I.classList.add("info-opponent"),"computer-attack"===e.getGameStatus()?I.textContent=`${k.name}`:I.textContent=`${x.name}`,N.append(T,B,M,I);const R=document.createElement("div");R.classList.add("info-div-text-div");const O=document.createElement("p");if("player-turn"===e.getGameStatus()){O.textContent="Click a square on your opponent's board to attack that square!";const tt=document.createElement("p");tt.textContent="-If your opponent has a ship occupying that square, their ship will receive a hit";const et=document.createElement("p");et.textContent="-If you hit all of the squares containing one of your opponent's ships, you'll sink that ship!";const nt=document.createElement("p");nt.textContent="-The game ends once either you or your opponent sinks all of the other player's ships on the board",R.append(O,tt,et,nt)}if("active-player-attack"===e.getGameStatus()||"computer-attack"===e.getGameStatus()||"game-over"===e.getGameStatus()){R.classList.add("info-div-player-attack");const at=document.createElement("div");at.classList.add("info-div-text-div-top"),"computer-attack"===e.getGameStatus()||"game-over"===e.getGameStatus()&&"computer"===e.getWinner().type?O.textContent=`The computer attacked: ${x.lastAttack.join("")}`:("active-player-attack"===e.getGameStatus()||"game-over"===e.getGameStatus()&&e.getWinner().id===k.id)&&(O.textContent=`You attacked: ${k.lastAttack.join("")}`);const st=document.createElement("p");let ot;if(ot="computer-attack"===e.getGameStatus()||"game-over"===e.getGameStatus()&&"computer"===e.getWinner().type?"SINK"===x.lastAttackResult?"HIT":x.lastAttackResult:"SINK"===k.lastAttackResult?"HIT":k.lastAttackResult,st.textContent="This was a "+ot,at.append(O,st),R.append(at),"game-over"!==e.getGameStatus()){if("computer-attack"===e.getGameStatus()&&"SINK"===x.lastAttackResult||"active-player-attack"===e.getGameStatus()&&"SINK"===k.lastAttackResult){const ut=document.createElement("div");ut.classList.add("sink-text-div");const mt=document.createElement("p");if(mt.textContent="*SHIP SUNK!*",ut.append(mt),"active-player-attack"===e.getGameStatus()){const pt=document.createElement("p");pt.textContent="Woo-hoo!",ut.append(pt)}R.append(ut)}const it=document.createElement("p");"computer-attack"===e.getGameStatus()?it.textContent=`Next turn: ${k.name}`:it.textContent=`Next turn: ${x.name}`;const ct=document.createElement("div");ct.classList.add("info-div-text-div-bottom");const lt=document.createElement("p");lt.textContent="Click OK to proceed:";const rt=document.createElement("button");function dt(){if("active-player-attack"===e.getGameStatus())if("computer"===x.type){(function(){let t,n;"computer"===e.getPlayer2().type&&(t=e.getPlayer2(),n=e.getPlayer1());const a=n.gameboard,s=a.getBoard();return{computerAttack:function(){const e="ABCDEFGHIJ".split(""),i="1,2,3,4,5,6,7,8,9,10".split(",");function c([t,e]){return!(t<0||t>9||e<0||e>9||Array.isArray(s[t][e])&&(s[t][e].includes("hit")||s[t][e].includes("miss")))}const l=[];function r(){const t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());l.push([t,e])}function d(t){const e=t[0],n=t[1];let a=null,s=null,o=null,i=null;return n+1<=9&&(a=[e,n+1]),n-1>=0&&(s=[e,n-1]),e-1>=0&&(o=[e-1,n]),e+1<=9&&(i=[e+1,n]),[a,s,o,i]}let u;if("HIT"===t.lastAttackResult&&1===t.attackTurn){const m=d([i.indexOf(t.lastAttack[1]),e.indexOf(t.lastAttack[0])]);let p=Math.floor(4*Math.random()),h=m[p];for(l.push(h);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():(p=Math.floor(4*Math.random()),h=m[p],l.push(h),l.shift())}else if("SINK"===t.lastAttackResult&&t.tryingToSink){const f=d(t.firstHit);let g=Math.floor(4*Math.random()),v=f[g];for(l.push(v);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():(g=Math.floor(4*Math.random()),v=f[g],l.push(v),l.shift())}else if(t.tryingToSink&&"HIT"===t.lastAttackResult&&1!==t.attackTurn){const E=i.indexOf(t.lastAttack[1]),S=e.indexOf(t.lastAttack[0]),y=t.firstHit[0],k=t.firstHit[1];if(E===y){let L=[E,S+1];if(c(L))u=L;else if(L=[E,S-1],c(L))u=L;else if(L=[y,k-1],c(L))u=L;else if(L=[y,k+1],c(L))u=L;else{const b=d(t.firstHit);let x=Math.floor(4*Math.random()),C=b[x];for(l.push(C);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():(x=Math.floor(4*Math.random()),C=b[x],l.push(C),l.shift())}}else if(S===k){let A=[E+1,S];if(c(A))u=A;else if(A=[E-1,S],c(A))u=A;else if(A=[y-1,k],c(A))u=A;else if(A=[y+1,k],c(A))u=A;else{const q=d(t.firstHit);let w=Math.floor(4*Math.random()),P=q[w];for(l.push(P);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():(w=Math.floor(4*Math.random()),P=q[w],l.push(P),l.shift())}}}else if(t.tryingToSink&&"MISS"===t.lastAttackResult&&1!==t.attackTurn){const G=t.firstHit[0],N=t.firstHit[1];if(t.hitButNotSunkShips.length>1){const T=i.indexOf(t.lastAttack[1]),B=e.indexOf(t.lastAttack[0]);if(T===G){let M=[G,N-1];if(c(M))u=M;else if(M=[G,N+1],c(M))u=M;else{const I=d(t.firstHit);let R=Math.floor(4*Math.random()),O=I[R];for(l.push(O);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():(R=Math.floor(4*Math.random()),O=I[R],l.push(O),l.shift())}}else if(B===N){let K=[G-1,N];if(c(K))u=K;else if(K=[G+1,N],c(K))u=K;else{const H=d(t.firstHit);let $=Math.floor(4*Math.random()),j=H[$];for(l.push(j);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():($=Math.floor(4*Math.random()),j=H[$],l.push(j),l.shift())}}}else{const W=["2","3A","3B","4","5"],F=s[G][N].filter((t=>W.includes(t)))[0],D=a.ships.filter((t=>t.id===F))[0];if(1===D.hits){const X=d(t.firstHit);let Y=Math.floor(4*Math.random()),J=X[Y];for(l.push(J);0!==l.length;)null!==l[0]&&c(l[0])?u=l.shift():(Y=Math.floor(4*Math.random()),J=X[Y],l.push(J),l.shift())}else{const U=[];s.forEach(((t,e)=>{let n=e;t.forEach(((t,e)=>{Array.isArray(t)&&t.includes(D.id)&&t.includes("hit")&&U.push([n,e])}))}));const V=U[0],z=U[1];if(V[0]===z[0]){let Q=[G,N-1];u=c(Q)?Q:[G,N+1]}else if(V[1]===z[1]){let Z=[G-1,N];u=c(Z)?Z:[G+1,N]}}}}else{const _=n.gameboard.ships,tt=_.filter((t=>!t.isSunk())),et=[tt[0]];for(let ot=0;ot<tt.length-1;ot++){const it=tt[ot+1],ct=et[0];it.length<=ct.length?et.unshift(it):et.push(it)}const nt=et[0],at=_.filter((t=>t.id===nt.id))[0];function st(t){const e=o(at,t),n=Object.values(e);let a=!1;for(let t=0;t<n.length;t++){const e=n[t];if(null!==e){const t=e.filter((t=>!c(t)));if(0===t.length){a=!0;break}}}return a}for(r();0!==l.length;)c(l[0])&&st(l[0])?u=l.shift():(r(),l.shift())}if(a.receiveAttack(u),t.lastAttack=[e[u[1]],i[u[0]]],s[u[0]][u[1]].includes("miss")&&(t.lastAttackResult="MISS",t.tryingToSink&&(t.attackTurn+=1)),s[u[0]][u[1]].includes("hit")){const lt=["2","3A","3B","4","5"],rt=s[u[0]][u[1]].filter((t=>lt.includes(t)))[0],dt=a.ships.filter((t=>t.id===rt))[0];if(s[u[0]][u[1]].includes("is sunk")){let ut;if(t.lastAttackResult="SINK",t.hitButNotSunkShips.forEach(((t,e)=>{t.id===dt.id&&(ut=e)})),t.hitButNotSunkShips.splice(ut,1),0===t.hitButNotSunkShips.length)delete t.hitButNotSunkShips,delete t.tryingToSink,delete t.firstHit,delete t.attackTurn;else{const mt=t.hitButNotSunkShips[0],pt=[];s.forEach(((t,e)=>{let n=e;t.forEach(((t,e)=>{Array.isArray(t)&&t.includes(mt.id)&&t.includes("hit")&&pt.push([n,e])}))})),t.firstHit=pt[0],t.attackTurn=pt.length}}else{if(t.lastAttackResult="HIT",t.hitButNotSunkShips||(t.hitButNotSunkShips=[]),0===t.hitButNotSunkShips.length)t.hitButNotSunkShips.push(dt);else{function ht(t,e){let n=!1;for(let a=0;a<e.length;a++){e[a].id===t.id&&(n=!0);break}return n}ht(dt,t.hitButNotSunkShips)||t.hitButNotSunkShips.push(dt)}t.tryingToSink?t.attackTurn+=1:(t.tryingToSink=!0,t.firstHit=u,t.attackTurn=1)}}}}})().computerAttack(),L.allShipsSunk()?(e.setGameStatus("game-over"),e.setWinner(x)):e.setGameStatus("computer-attack"),l.updateScreen();const t=document.querySelector(".info-div-text-div-top"),n=t.firstElementChild,a=n.nextElementSibling;if("game-over"===e.getGameStatus()){const t=document.querySelector(".game-over-div"),e=document.querySelector(".game-over-buttons"),s=document.querySelectorAll(".game-over-regular-wait"),o=document.querySelectorAll(".game-over-hit-ship-wait");setTimeout((()=>{n.classList.remove("hidden")}),1e3),setTimeout((()=>{a.classList.remove("hidden")}),2500),setTimeout((()=>{const t=["2","3A","3B","4","5"];s.forEach((e=>{e.classList.remove("game-over-regular-wait"),t.forEach((t=>{A[Number(e.dataset.row)][Number(e.dataset.column)].includes(t)&&(e.textContent="3A"===t||"3B"===t?"3":t)}))})),void 0!==o&&o.forEach((e=>{e.classList.remove("game-over-hit-ship-wait"),t.forEach((t=>{A[Number(e.dataset.row)][Number(e.dataset.column)].includes(t)&&(e.textContent="3A"===t||"3B"===t?"3":t)}))}))}),4e3),setTimeout((()=>{t.classList.remove("hidden")}),4e3),setTimeout((()=>{e.classList.remove("hidden")}),4e3)}if("computer-attack"===e.getGameStatus()){let e,s;"SINK"===x.lastAttackResult?(e=document.querySelector(".sink-text-div"),s=e.nextElementSibling):s=t.nextElementSibling;const o=document.querySelector(".info-div-text-div-bottom"),i=document.querySelectorAll(".wait");setTimeout((()=>{i.forEach((t=>t.classList.remove("wait")))}),1e3),setTimeout((()=>{n.classList.remove("hidden")}),1e3),setTimeout((()=>{a.classList.remove("hidden")}),2500),"SINK"===x.lastAttackResult?(setTimeout((()=>{e.classList.remove("hidden")}),4e3),setTimeout((()=>{s.classList.remove("hidden")}),5500),setTimeout((()=>{o.classList.remove("hidden")}),5500)):(setTimeout((()=>{s.classList.remove("hidden")}),4e3),setTimeout((()=>{o.classList.remove("hidden")}),4e3))}}else e.switchPlayerTurn(),e.setGameStatus("player-turn"),l.updateScreen();else e.setGameStatus("player-turn"),l.updateScreen()}rt.textContent="OK",ct.append(lt,rt),rt.addEventListener("click",dt),R.append(it,ct)}else{const ht=document.createElement("div");ht.classList.add("game-over-div");const ft=document.createElement("p");ft.textContent="*GAME OVER!*";const gt=document.createElement("p");C.allShipsSunk()?"computer"===x.type?gt.textContent="Congrats! You win!":gt.textContent=`${k.name} wins!`:gt.textContent="Sorry, you lose :(",ht.append(ft,gt);const vt=document.createElement("div");vt.classList.add("game-over-buttons");const Et=document.createElement("button");Et.textContent="Play again";const St=document.createElement("button");St.textContent="Change players",vt.append(Et,St),R.append(ht,vt),Et.addEventListener("click",(()=>{"computer"===e.getPlayer2().type?e.startGame(e.getPlayer1().name):e.startGame(e.getPlayer1().name,e.getPlayer2().name,"human"),e.setGameStatus("ship-placement"),l.updateScreen()})),St.addEventListener("click",a)}}if(G.append(N,R),t.append(G),"active-player-attack"===e.getGameStatus()||"computer-attack"===e.getGameStatus()||"game-over"===e.getGameStatus()){const yt=document.querySelector(".info-div-text-div-top"),kt=yt.firstElementChild,Lt=kt.nextElementSibling;let bt,xt;"active-player-attack"===e.getGameStatus()?"SINK"===k.lastAttackResult?(bt=document.querySelector(".sink-text-div"),xt=bt.nextElementSibling):xt=yt.nextElementSibling:"game-over"!==e.getGameStatus()&&("SINK"===x.lastAttackResult?(bt=document.querySelector(".sink-text-div"),xt=bt.nextElementSibling):xt=yt.nextElementSibling);const Ct=document.querySelector(".game-over-div"),At=document.querySelector(".game-over-buttons"),qt=document.querySelector(".info-div-text-div-bottom");("computer-attack"===e.getGameStatus()||"game-over"===e.getGameStatus()&&"computer"===e.getWinner().type)&&kt.classList.add("hidden"),Lt.classList.add("hidden"),("active-player-attack"===e.getGameStatus()&&"SINK"===k.lastAttackResult||"computer-attack"===e.getGameStatus()&&"SINK"===x.lastAttackResult)&&bt.classList.add("hidden"),"game-over"===e.getGameStatus()&&(Ct.classList.add("hidden"),At.classList.add("hidden")),"game-over"!==e.getGameStatus()&&(xt.classList.add("hidden"),qt.classList.add("hidden"))}const K=document.createElement("div");K.classList.add("opponent-section");const H=document.createElement("h2");H.textContent=`${x.name}'s waters:`;const $=document.createElement("div");$.classList.add("board-div");const j=document.createElement("div");j.classList.add("column-labels");for(let wt=0;wt<10;wt++){const Pt=document.createElement("p");Pt.textContent=i[wt],j.append(Pt)}const W=document.createElement("div");W.classList.add("row-labels");for(let Gt=0;Gt<10;Gt++){const Nt=document.createElement("p");Nt.textContent=r[Gt],W.append(Nt)}const F=document.createElement("div");F.classList.add("board"),$.append(j,W,F),K.append(H,$);const D=document.createElement("div");D.classList.add("active-player-section");const X=document.createElement("h2");X.textContent=`${k.name}'s waters:`;const Y=document.createElement("div");Y.classList.add("board-div");const J=document.createElement("div");J.classList.add("column-labels");for(let Tt=0;Tt<10;Tt++){const Bt=document.createElement("p");Bt.textContent=i[Tt],J.append(Bt)}const U=document.createElement("div");U.classList.add("row-labels");for(let Mt=0;Mt<10;Mt++){const It=document.createElement("p");It.textContent=r[Mt],U.append(It)}const V=document.createElement("div");V.classList.add("board"),Y.append(J,U,V),D.append(X,Y),t.append(K,D),A.forEach(((t,n)=>{let a=n;t.forEach(((t,n)=>{const s=document.createElement("div");if(s.classList.add("square"),s.dataset.row=a,s.dataset.column=n,Array.isArray(t))if(t.includes("miss")&&s.classList.add("miss"),"game-over"===e.getGameStatus())["2","3A","3B","4","5"].forEach((e=>{t.includes(e)&&(t.includes("is sunk")?s.classList.add("is-sunk"):(s.classList.add("missed-ship"),t.includes("hit")?(s.classList.add("game-over-hit-ship-wait"),s.textContent="X"):s.classList.add("game-over-regular-wait")),s.classList.contains("missed-ship")||(s.textContent="3A"===e||"3B"===e?"3":e))}));else if(t.includes("hit"))if(s.classList.add("hit"),t.includes("is sunk")){s.classList.add("is-sunk");const e=["2","3A","3B","4","5"].filter((e=>t.includes(e)))[0];s.textContent="3A"===e||"3B"===e?"3":e}else s.textContent="X";F.appendChild(s)}))}));const z=F.querySelectorAll(".square");function Q(t){t.target.classList.toggle("hover")}function Z(t){const n=t.target.dataset.row,a=t.target.dataset.column;C.receiveAttack([n,a]),k.lastAttack=[i[Number(a)],r[Number(n)]],A[n][a].includes("miss")&&(k.lastAttackResult="MISS"),A[n][a].includes("hit")&&(A[n][a].includes("is sunk")?k.lastAttackResult="SINK":k.lastAttackResult="HIT"),C.allShipsSunk()?(e.setGameStatus("game-over"),e.setWinner(k)):e.setGameStatus("active-player-attack"),l.updateScreen();const s=document.querySelector(".info-div-text-div-top");if("game-over"===e.getGameStatus()){const t=s.firstElementChild,e=t.nextElementSibling,n=document.querySelector(".game-over-div"),a=document.querySelector(".game-over-buttons");setTimeout((()=>{t.classList.remove("hidden")}),1e3),setTimeout((()=>{e.classList.remove("hidden")}),2500),setTimeout((()=>{n.classList.remove("hidden")}),4e3),setTimeout((()=>{a.classList.remove("hidden")}),4e3)}if("active-player-attack"===e.getGameStatus()){const t=s.lastElementChild;let e,n;"SINK"===k.lastAttackResult?(e=document.querySelector(".sink-text-div"),n=e.nextElementSibling):n=s.nextElementSibling;const a=document.querySelector(".info-div-text-div-bottom");setTimeout((()=>{t.classList.remove("hidden")}),1500),"SINK"===k.lastAttackResult?(setTimeout((()=>{e.classList.remove("hidden")}),3e3),setTimeout((()=>{n.classList.remove("hidden")}),4500),setTimeout((()=>{a.classList.remove("hidden")}),4500)):(setTimeout((()=>{n.classList.remove("hidden")}),3e3),setTimeout((()=>{a.classList.remove("hidden")}),3e3))}}if("player-turn"===e.getGameStatus()&&z.forEach((t=>{t.classList.contains("hit")||t.classList.contains("miss")||(t.addEventListener("mouseover",Q),t.addEventListener("mouseout",Q),t.addEventListener("click",Z))})),b.forEach(((t,e)=>{let n=e;t.forEach(((t,e)=>{const a=document.createElement("div");a.classList.add("square"),a.dataset.row=n,a.dataset.column=e,null!==t&&(t.includes("miss")?a.classList.add("miss"):["2","3A","3B","4","5"].forEach((e=>{t.includes(e)&&(a.classList.add("active-player-ship"),t.includes("hit")&&a.classList.add("hit"),t.includes("is sunk")&&a.classList.add("is-sunk"),a.textContent="3A"===e||"3B"===e?"3":e)}))),V.append(a)}))})),"computer-attack"===e.getGameStatus()){const Rt=r.indexOf(x.lastAttack[1]),Ot=i.indexOf(x.lastAttack[0]),Kt=document.querySelector(".active-player-section"),Ht=Kt.querySelector(`[data-row="${Rt}"][data-column="${Ot}"]`);if("SINK"!==x.lastAttackResult)Ht.classList.add("wait");else{const $t=["2","3A","3B","4","5"],jt=b[Rt][Ot].filter((t=>$t.includes(t)))[0],Wt=[];b.forEach(((t,e)=>{let n=e;t.forEach(((t,e)=>{Array.isArray(t)&&t.includes(jt)&&Wt.push(Kt.querySelector(`[data-row="${n}"][data-column="${e}"]`))}))})),Wt.forEach((t=>t.classList.add("wait")))}}const _=document.createElement("p");if(_.textContent="Opponent ships remaining:",P.append(_),C.allShipsSunk()){const Ft=document.createElement("div");Ft.classList.add("empty-square-div"),P.append(Ft)}if(q.forEach((t=>{if(!t.isSunk()){const e=document.createElement("div");e.classList.add("ship-div");for(let n=0;n<t.length;n++){const n=document.createElement("div");n.textContent=t.length.toString(),e.append(n)}P.append(e)}})),"human"===e.getPlayer2().type&&"player-turn"===e.getGameStatus()){const Dt=document.createElement("dialog");Dt.id="next-player-turn-dialog";const Xt=document.createElement("div"),Yt=document.createElement("span");Yt.classList.add("next-player-dialog-player2-name"),Yt.textContent=k.name;const Jt=Yt.cloneNode(!0),Ut=Yt.cloneNode(!0),Vt=document.createElement("span");Vt.classList.add("next-player-dialog-player1-name"),Vt.textContent=x.name;const zt=document.createElement("p");zt.append("Next up: ",Yt);const Qt=document.createElement("p");Qt.append(Vt,", pass the screen to ",Jt,"!");const Zt=document.createElement("p");Zt.append(Ut,", click OK when you're ready!");const _t=document.createElement("div");_t.classList.add("next-player-dialog-buttons");const te=document.createElement("button");te.textContent="OK",_t.append(te),Xt.append(zt,Qt,Zt,_t),Dt.append(Xt),w.append(Dt),te.addEventListener("click",(()=>{if(Dt.close(),Dt.remove(),null!==x.lastAttack){const t=document.createElement("dialog");t.id="last-turn-dialog";const e=document.createElement("div"),n=document.createElement("p"),a=document.createElement("span");a.classList.add("next-player-dialog-player1-name"),a.textContent=x.name,n.append("Last turn: ",a,` attacked ${x.lastAttack.join("")}`);const s=document.createElement("p");let o;o="SINK"===x.lastAttackResult?"HIT":x.lastAttackResult,s.textContent="This was a "+o;const i=document.createElement("p"),c=document.createElement("p");"SINK"===x.lastAttackResult?(i.textContent="*SHIP SUNK!*",i.classList.add("ship-sunk-text"),c.textContent="Click OK to continue:"):i.textContent="Click OK to continue:";const l=document.createElement("div");l.classList.add("next-player-dialog-buttons");const r=document.createElement("button");r.textContent="OK",l.append(r),e.append(n,s,i,l),"SINK"===x.lastAttackResult&&l.before(c),t.append(e),w.append(t),r.addEventListener("click",(()=>{t.close(),t.remove()})),t.showModal()}})),Dt.showModal()}}}};return t(),{updateScreen:t}}()})();
//# sourceMappingURL=main.js.map